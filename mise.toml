[tools]
node = "25.1"
"npm:@anthropic-ai/claude-code" = "latest"
"npm:vercel" = "latest"
pnpm = "10.20"


[tasks.setup-supabase-env]
description = "Set up Supabase environment variables"
run = "supabase status -o env > mlx-local/.env"

[tasks.server]
description = "Run the image browser server"
run = "pnpm run server:dev"

[tasks.run-mlx-local]
description = "Run the local MLX image browser"
run = "cd mlx-local && mise run install && mise run web"

[tasks.upload]
description = "Run the image uploader"
run = "pnpm run upload"

[tasks.fast-upload]
description = "Run the image uploader with fast mode"
run = "UPLOAD_CONCURRENCY=16 SKIP_R2_HEAD=true pnpm run upload"

[tasks.embed]
description = "Run the image embedder"
run = "pnpm run embed"

[tasks.sync]
description = "Run the image syncer"
run = "pnpm run sync"

[tasks.ensure-schema]
description = "Ensure database schema exists"
run = "pnpm run ensure-schema"

[tasks.validate]
description = "Validate environment (database, R2 bucket, URLs)"
run = "pnpm run validate"

[tasks.backfill-dimensions]
description = "Backfill width/height for existing images"
run = "pnpm run backfill-dimensions"
