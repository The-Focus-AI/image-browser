---
title: "6:37:37 AM - November 6, 2025"
date: 2025-11-06T11:37:37.613Z
timestamp: 1762429057613
---

## Project Notes

Current structure analysis:
- loader/ has: db.ts, r2.ts, replicate.ts, upload_r2.ts, embed_missing.ts, sync.ts
- browse/ has: db.ts (duplicate!), replicate.ts (duplicate with different model defaults), server.ts, template.html
- Both have separate package.json with overlapping dependencies
- Both connect to same Supabase DB but through separate connection pools
- Hardcoded table name "image_embeddings" in 4 locations

Shared code opportunities:
- db.ts can be unified (same connection logic, just table name parameterized)
- r2.ts only in loader but browse references R2 via IMAGE_BASE_URL
- replicate.ts has text vs image methods - can combine into one module
- Template rendering could be shared if syncer needs status pages

Clear separation:
- Syncer: upload_r2.ts, embed_missing.ts, sync.ts orchestration
- Server: server.ts, template.html, static assets
- Shared: db, r2, replicate utilities
